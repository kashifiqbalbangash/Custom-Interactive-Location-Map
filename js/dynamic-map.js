function initDynamicMap(mapId, mapData) {
    const defaultSettings = {
        center: [37.8, -96],
        zoom: 5,
        maxZoom: 10,
        minZoom: 4,
        maxBounds: [
            [24.396308, -125.0],
            [49.384358, -66.93457]
        ],
        maxBoundsViscosity: 1.0
    };

    // Merge default settings with map data
    const settings = { ...defaultSettings, ...mapData };
    
    // Initialize map
    const map = L.map(`map-${mapId}`, {
        center: settings.center,
        zoom: settings.zoom,
        maxZoom: settings.maxZoom,
        minZoom: settings.minZoom,
        maxBounds: settings.maxBounds,
        maxBoundsViscosity: settings.maxBoundsViscosity
    });

    // Add tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);
	const baseurl = "https://plumbing.elitewebstudios.com/";
	if (!settings.markers) {
		settings.markers = [];
	}
	settings.markers = settings.markers.concat([
    		{ name: "San Francisco", coords: [37.7749, -122.4194], url: baseurl + "san-francisco" },
            { name: "San Jose", coords: [37.3382, -121.8863], url: baseurl + "san-jose" },
            { name: "Los Angeles", coords: [34.0522, -118.2437], url: baseurl + "los-angeles" },
            { name: "San Diego", coords: [32.7157, -117.1611], url: baseurl + "san-diego" },
            { name: "Seattle", coords: [47.6062, -122.3321], url: baseurl + "seattle" },
            { name: "Portland", coords: [45.5051, -122.6750], url: baseurl + "portland" },
            { name: "Phoenix", coords: [33.4484, -112.0740], url: baseurl + "phoenix" },
            { name: "Las Vegas", coords: [36.1699, -115.1398], url: baseurl + "las-vegas" },
            { name: "Chicago", coords: [41.8781, -87.6298], url: baseurl + "chicago" },
            { name: "Minneapolis", coords: [44.9778, -93.2650], url: baseurl + "minneapolis" },
            { name: "Columbus", coords: [39.9612, -82.9988], url: baseurl + "columbus" },
            { name: "Indianapolis", coords: [39.7684, -86.1581], url: baseurl + "indianapolis" },
            { name: "St. Louis", coords: [38.6270, -90.1994], url: baseurl + "st-louis" },
            { name: "Kansas City", coords: [39.0997, -94.5786], url: baseurl + "kansas-city" },
            { name: "Austin", coords: [30.2672, -97.7431], url: baseurl + "austin" },
            { name: "Dallas", coords: [32.7767, -96.7970], url: baseurl + "dallas" },
            { name: "Houston", coords: [29.7604, -95.3698], url: baseurl + "houston" },
            { name: "San Antonio", coords: [29.4241, -98.4936], url: baseurl + "san-antonio" },
            { name: "Atlanta", coords: [33.7490, -84.3880], url: baseurl + "atlanta" },
            { name: "Miami", coords: [25.7617, -80.1918], url: baseurl + "miami" },
            { name: "Tampa", coords: [27.9506, -82.4572], url: baseurl + "tampa" },
            { name: "Orlando", coords: [28.5383, -81.3792], url: baseurl + "orlando" },
            { name: "Charlotte", coords: [35.2271, -80.8431], url: baseurl + "charlotte" },
            { name: "Raleigh", coords: [35.7796, -78.6382], url: baseurl + "raleigh" },
            { name: "Nashville", coords: [36.1627, -86.7816], url: baseurl + "nashville" },
            { name: "Richmond", coords: [37.5407, -77.4360], url: baseurl + "richmond" },
            { name: "New York City", coords: [40.7128, -74.0060], url: baseurl + "new-york" },
            { name: "Boston", coords: [42.3601, -71.0589], url: baseurl + "boston" },
            { name: "Philadelphia", coords: [39.9526, -75.1652], url: baseurl + "philadelphia" },
            { name: "Pittsburgh", coords: [40.4406, -79.9959], url: baseurl + "pittsburgh" },
            { name: "Washington, D.C.", coords: [38.9072, -77.0369], url: baseurl + "washington-dc" },
            { name: "Baltimore", coords: [39.2904, -76.6122], url: baseurl + "baltimore" },
            { name: "Denver", coords: [39.7392, -104.9903], url: baseurl + "denver" },
            { name: "Boulder", coords: [40.0150, -105.2705], url: baseurl + "boulder" },
            { name: "Salt Lake City", coords: [40.7608, -111.8910], url: baseurl + "salt-lake-city" },
            { name: "Boise", coords: [43.6150, -116.2023], url: baseurl + "boise" },
            { name: "Omaha", coords: [41.2565, -95.9345], url: baseurl + "omaha" },
            { name: "Lincoln", coords: [40.8136, -96.7026], url: baseurl + "lincoln" },
            { name: "Des Moines", coords: [41.5868, -93.6250], url: baseurl + "des-moines" },
            { name: "Cedar Rapids", coords: [41.9779, -91.6656], url: baseurl + "cedar-rapids" },
            { name: "Sioux Falls", coords: [43.5446, -96.7311], url: baseurl + "sioux-falls" },
            { name: "Fargo", coords: [46.8772, -96.7898], url: baseurl + "fargo" },
            { name: "Bismarck", coords: [46.8083, -100.7837], url: baseurl + "bismarck" },
            { name: "Billings", coords: [45.7833, -108.5007], url: baseurl + "billings" },
            { name: "Missoula", coords: [46.8721, -113.9940], url: baseurl + "missoula" },
            { name: "Cheyenne", coords: [41.1400, -104.8202], url: baseurl + "cheyenne" },
            { name: "Casper", coords: [42.8666, -106.3131], url: baseurl + "casper" },
            { name: "Albuquerque", coords: [35.0844, -106.6504], url: baseurl + "albuquerque" },
            { name: "Santa Fe", coords: [35.6869, -105.9378], url: baseurl + "santa-fe" },
            { name: "El Paso", coords: [31.7619, -106.4850], url: baseurl + "el-paso" },
            { name: "Lubbock", coords: [33.5779, -101.8552], url: baseurl + "lubbock" },
            { name: "Amarillo", coords: [35.2219, -101.8313], url: baseurl + "amarillo" },
            { name: "Tulsa", coords: [36.1540, -95.9928], url: baseurl + "tulsa" },
            { name: "Oklahoma City", coords: [35.4676, -97.5164], url: baseurl + "oklahoma-city" },
            { name: "Little Rock", coords: [34.7465, -92.2896], url: baseurl + "little-rock" },
            { name: "Baton Rouge", coords: [30.4515, -91.1871], url: baseurl + "baton-rouge" },
            { name: "New Orleans", coords: [29.9511, -90.0715], url: baseurl + "new-orleans" },
            { name: "Jackson", coords: [32.2988, -90.1848], url: baseurl + "jackson" },
            { name: "Memphis", coords: [35.1495, -90.0490], url: baseurl + "memphis" },
            { name: "Charleston", coords: [32.7765, -79.9311], url: baseurl + "charleston" },
            { name: "Greenville", coords: [34.8526, -82.3940], url: baseurl + "greenville" },
            { name: "Columbia", coords: [34.0007, -81.0348], url: baseurl + "columbia" },
            { name: "Knoxville", coords: [35.9606, -83.9207], url: baseurl + "knoxville" },
            { name: "Chattanooga", coords: [35.0456, -85.3097], url: baseurl + "chattanooga" },
            { name: "Mobile", coords: [30.6954, -88.0399], url: baseurl + "mobile" },
            { name: "Montgomery", coords: [32.3792, -86.3077], url: baseurl + "montgomery" },
            { name: "Birmingham", coords: [33.5186, -86.8104], url: baseurl + "birmingham" },
            { name: "Huntsville", coords: [34.7304, -86.5861], url: baseurl + "huntsville" },
            { name: "Savannah", coords: [32.0809, -81.0912], url: baseurl + "savannah" },
            { name: "Augusta", coords: [33.4735, -82.0105], url: baseurl + "augusta" },
            { name: "Macon", coords: [32.8407, -83.6324], url: baseurl + "macon" },
            { name: "Pensacola", coords: [30.4213, -87.2169], url: baseurl + "pensacola" },
            { name: "Gainesville", coords: [29.6516, -82.3248], url: baseurl + "gainesville" },
            { name: "Fort Myers", coords: [26.6406, -81.8723], url: baseurl + "fort-myers" },
            { name: "West Palm Beach", coords: [26.7153, -80.0534], url: baseurl + "west-palm-beach" },
            { name: "Daytona Beach", coords: [29.2108, -81.0228], url: baseurl + "daytona-beach" },
            { name: "Naples", coords: [26.1420, -81.7948], url: baseurl + "naples" },
            { name: "Fort Lauderdale", coords: [26.1224, -80.1373], url: baseurl + "fort-lauderdale" },
            { name: "Hollywood", coords: [26.0112, -80.1495], url: baseurl + "hollywood" },
            { name: "Boca Raton", coords: [26.3683, -80.1289], url: baseurl + "boca-raton" },
            { name: "Sarasota", coords: [27.3364, -82.5307], url: baseurl + "sarasota" },
            { name: "Clearwater", coords: [27.9659, -82.8001], url: baseurl + "clearwater" },
            { name: "Lakeland", coords: [28.0395, -81.9498], url: baseurl + "lakeland" },
            { name: "St. Petersburg", coords: [27.7676, -82.6403], url: baseurl + "st-petersburg" },
            { name: "Ocala", coords: [29.1872, -82.1401], url: baseurl + "ocala" },
            { name: "Port St. Lucie", coords: [27.2730, -80.3582], url: baseurl + "port-st-lucie" },
            { name: "Melbourne", coords: [28.0836, -80.6081], url: baseurl + "melbourne" },
            { name: "Vero Beach", coords: [27.6386, -80.3973], url: baseurl + "vero-beach" },
            { name: "Davenport", coords: [28.1586, -81.6017], url: baseurl + "davenport" },
            { name: "Delray Beach", coords: [26.4615, -80.0728], url: baseurl + "delray-beach" },
            { name: "Anchorage", coords: [61.2181, -149.9003], url: baseurl + "anchorage" },
            { name: "Honolulu", coords: [21.3069, -157.8583], url: baseurl + "honolulu" },
            { name: "Madison", coords: [43.0731, -89.4012], url: baseurl + "madison" },
            { name: "Milwaukee", coords: [43.0389, -87.9065], url: baseurl + "milwaukee" },
            { name: "Norfolk", coords: [36.8508, -76.2859], url: baseurl + "norfolk" },
            { name: "Buffalo", coords: [42.8864, -78.8784], url: baseurl + "buffalo" },
            { name: "Rochester", coords: [43.1566, -77.6088], url: baseurl + "rochester" },
            { name: "Albany", coords: [42.6526, -73.7562], url: baseurl + "albany" },
            { name: "Providence", coords: [41.8240, -71.4128], url: baseurl + "providence" },
            { name: "Hartford", coords: [41.7658, -72.6734], url: baseurl + "hartford" },
            { name: "Manchester", coords: [42.9956, -71.4548], url: baseurl + "manchester" },
            { name: "Montpelier", coords: [44.2601, -72.5754], url: baseurl + "montpelier" },
            { name: "Bozeman", coords: [45.6769, -111.0429], url: baseurl + "bozeman" },
            { name: "Casper", coords: [42.8501, -106.3252], url: baseurl + "casper" },
            { name: "Dover", coords: [39.1582, -75.5244], url: baseurl + "dover" },
            { name: "Wilmington", coords: [39.7447, -75.5484], url: baseurl + "wilmington" },
            { name: "Augusta", coords: [44.3106, -69.7795], url: baseurl + "augusta" },
            { name: "Portland (Maine)", coords: [43.6591, -70.2568], url: baseurl + "portland-me" },
            { name: "Louisville", coords: [38.2527, -85.7585], url: baseurl + "louisville" },
            { name: "Bowling Green", coords: [36.9685, -86.4436], url: baseurl + "bowling-green" },
            { name: "Kalamazoo", coords: [42.2917, -85.5872], url: baseurl + "kalamazoo" },
            { name: "Grand Rapids", coords: [42.9634, -85.6681], url: baseurl + "grand-rapids" },
            { name: "Detroit", coords: [42.3314, -83.0458], url: baseurl + "detroit" },
            { name: "Traverse City", coords: [44.7631, -85.6206], url: baseurl + "traverse-city" },
            { name: "Lansing", coords: [42.7325, -84.5555], url: baseurl + "lansing" },
            { name: "Warren", coords: [42.5145, -83.0147], url: baseurl + "warren" },
            { name: "East Lansing", coords: [42.7368, -84.4839], url: baseurl + "east-lansing" },
            { name: "St. Paul", coords: [44.9537, -93.0900], url: baseurl + "st-paul" },
            { name: "Rochester", coords: [44.0121, -92.4802], url: baseurl + "rochester" },
            { name: "Duluth", coords: [46.7867, -92.1005], url: baseurl + "duluth" },
            { name: "Bloomington", coords: [39.1653, -86.5264], url: baseurl + "bloomington" },
            { name: "Evansville", coords: [37.9779, -87.5711], url: baseurl + "evansville" },
            { name: "Fort Wayne", coords: [41.0793, -85.1394], url: baseurl + "fort-wayne" },
            { name: "Davenport", coords: [41.5236, -90.5776], url: baseurl + "davenport" },
            { name: "Sioux City", coords: [42.4997, -96.4003], url: baseurl + "sioux-city" },
            { name: "Cedar Falls", coords: [42.5341, -92.4455], url: baseurl + "cedar-falls" },
            { name: "Burlington", coords: [40.8089, -91.1621], url: baseurl + "burlington" },
            { name: "Columbia", coords: [38.9517, -92.3341], url: baseurl + "columbia" },
            { name: "Springfield", coords: [39.7817, -89.6501], url: baseurl + "springfield" },
            { name: "Jefferson City", coords: [38.5767, -92.1735], url: baseurl + "jefferson-city" },
            { name: "Jeffersonville", coords: [38.2773, -85.7395], url: baseurl + "jeffersonville" },
            { name: "Bozeman", coords: [45.6770, -111.0429], url: baseurl + "bozeman" },
            { name: "Missoula", coords: [46.8787, -113.9962], url: baseurl + "missoula" },
            { name: "Helena", coords: [46.5958, -112.0270], url: baseurl + "helena" },
            { name: "Great Falls", coords: [47.5002, -111.3000], url: baseurl + "great-falls" },
            { name: "Idaho Falls", coords: [43.4916, -112.0331], url: baseurl + "idaho-falls" },
            { name: "Twin Falls", coords: [42.5623, -114.4609], url: baseurl + "twin-falls" },
            { name: "Hawaii", coords: [20.7984, -156.3319], url: baseurl + "hawaii" },
            { name: "Juneau", coords: [58.3019, -134.4197], url: baseurl + "juneau" },
            { name: "Fairbanks", coords: [64.8378, -147.7164], url: baseurl + "fairbanks" },
            { name: "Lihue", coords: [21.9746, -159.3677], url: baseurl + "lihue" },
            { name: "Grand Junction", coords: [39.5501, -108.5506], url: baseurl + "grand-junction" },
            { name: "Durango", coords: [37.2753, -107.8801], url: baseurl + "durango" },
            { name: "Fort Collins", coords: [40.5853, -105.0844], url: baseurl + "fort-collins" },
            { name: "Colorado Springs", coords: [38.8339, -104.8214], url: baseurl + "colorado-springs" },
            { name: "Greeley", coords: [40.4233, -104.7091], url: baseurl + "greeley" },
            { name: "Pueblo", coords: [38.2544, -104.6097], url: baseurl + "pueblo" },
            { name: "Aspen", coords: [39.1911, -106.8175], url: baseurl + "aspen" },
            { name: "Laramie", coords: [41.3124, -105.5911], url: baseurl + "laramie" },
            { name: "Casper", coords: [42.8507, -106.3272], url: baseurl + "casper" },
            { name: "Gillette", coords: [44.2906, -105.5022], url: baseurl + "gillette" },
            { name: "Lander", coords: [42.8340, -108.7347], url: baseurl + "lander" },
            { name: "Rock Springs", coords: [41.5868, -109.1997], url: baseurl + "rock-springs" },
            { name: "Pinedale", coords: [42.8661, -109.8618], url: baseurl + "pinedale" },
            { name: "Lexington", coords: [38.0406, -84.5037], url: baseurl + "lexington" },
            { name: "Provo", coords: [40.2338, -111.6585], url: baseurl + "provo" },
            { name: "Ogden", coords: [41.2230, -111.9738], url: baseurl + "ogden" },
            { name: "Logan", coords: [41.7369, -111.8335], url: baseurl + "logan" },
            { name: "St. George", coords: [37.0965, -113.5838], url: baseurl + "st-george" },
            { name: "Bountiful", coords: [40.8890, -111.8807], url: baseurl + "bountiful" },
            { name: "Sandy", coords: [40.5724, -111.8480], url: baseurl + "sandy" },
            { name: "Layton", coords: [41.0634, -111.9736], url: baseurl + "layton" },
            { name: "Tucson", coords: [32.2226, -110.9747], url: baseurl + "tucson" },
            { name: "Mesa", coords: [33.4152, -111.8315], url: baseurl + "mesa" },
            { name: "Chandler", coords: [33.3062, -111.8413], url: baseurl + "chandler" },
            { name: "Scottsdale", coords: [33.4942, -111.9261], url: baseurl + "scottsdale" },
            { name: "Glendale", coords: [33.5387, -112.1860], url: baseurl + "glendale" },
            { name: "Gilbert", coords: [33.3528, -111.7890], url: baseurl + "gilbert" },
            { name: "Tempe", coords: [33.4255, -111.9400], url: baseurl + "tempe" },
            { name: "Peoria", coords: [33.5806, -112.2373], url: baseurl + "peoria" },
            { name: "Avondale", coords: [33.4356, -112.3496], url: baseurl + "avondale" },
            { name: "Flagstaff", coords: [35.1983, -111.6513], url: baseurl + "flagstaff" },
            { name: "Kingman", coords: [35.1895, -113.0270], url: baseurl + "kingman" },
            { name: "Show Low", coords: [34.2665, -109.9462], url: baseurl + "show-low" },
            { name: "Prescott", coords: [34.5400, -112.4685], url: baseurl + "prescott" },
            { name: "Yuma", coords: [32.6927, -113.4817], url: baseurl + "yuma" },
            { name: "Pine Bluff", coords: [34.2265, -92.0032], url: baseurl + "pine-bluff" },
            { name: "Fort Smith", coords: [35.3606, -94.3710], url: baseurl + "fort-smith" },
            { name: "Jonesboro", coords: [35.8423, -90.7015], url: baseurl + "jonesboro" },
            { name: "Conway", coords: [35.0887, -92.4421], url: baseurl + "conway" },
            { name: "Hot Springs", coords: [34.5037, -93.0552], url: baseurl + "hot-springs" },
            { name: "Bentonville", coords: [36.3729, -94.2088], url: baseurl + "bentonville" },
            { name: "Springdale", coords: [36.1820, -94.1288], url: baseurl + "springdale" },
            { name: "Fayetteville", coords: [36.0822, -94.1719], url: baseurl + "fayetteville" },
            { name: "North Little Rock", coords: [34.7692, -92.2671], url: baseurl + "north-little-rock" },
            { name: "Monticello", coords: [33.6364, -91.7902], url: baseurl + "monticello" },
            { name: "Montgomery", coords: [32.3792, -86.3000], url: baseurl + "montgomery" },
            { name: "Tuscaloosa", coords: [33.2098, -87.5692], url: baseurl + "tuscaloosa" },
            { name: "Dothan", coords: [31.2234, -85.3905], url: baseurl + "dothan" },
            { name: "Decatur", coords: [34.6059, -86.9833], url: baseurl + "decatur" },
            { name: "Opelika", coords: [32.6458, -85.3742], url: baseurl + "opelika" },
            { name: "Auburn", coords: [32.6099, -85.4808], url: baseurl + "auburn" },
            { name: "Madison", coords: [34.6996, -86.7483], url: baseurl + "madison" },
            { name: "Gadsden", coords: [33.6307, -85.9919], url: baseurl + "gadsden" },
            { name: "Bessemer", coords: [33.3966, -86.9468], url: baseurl + "bessemer" },
            { name: "Anniston", coords: [33.6591, -85.8312], url: baseurl + "anniston" },
            { name: "Florence", coords: [34.7990, -87.6777], url: baseurl + "florence" },
            { name: "Fairhope", coords: [30.5207, -87.9026], url: baseurl + "fairhope" },
            { name: "Selma", coords: [32.4074, -87.0211], url: baseurl + "selma" },
            { name: "Savannah", coords: [32.0836, -81.0998], url: baseurl + "savannah" },
            { name: "Augusta", coords: [33.4735, -81.9748], url: baseurl + "augusta" },
            { name: "Athens", coords: [33.9605, -83.9594], url: baseurl + "athens" },
            { name: "Valdosta", coords: [30.8327, -83.2785], url: baseurl + "valdosta" },
            { name: "Tifton", coords: [31.4587, -83.5043], url: baseurl + "tifton" }
			// Add more markers as needed...
		]);
// console.log(settings.markers);
    // Add markers if they exist
    if (settings.markers && Array.isArray(settings.markers)) {
        settings.markers.forEach(marker => {
            const mapMarker = L.marker(marker.coords).addTo(map);
            
            // Add popup if URL exists
            if (marker.url) {
                mapMarker.bindPopup(`<a href="${marker.url}" target="_blank"><strong>${marker.name}</strong></a>`);
            } else {
                mapMarker.bindPopup(`<strong>${marker.name}</strong>`);
            }
            
            // Add tooltip
            mapMarker.bindTooltip(`<strong>${marker.name}</strong>`, {
                permanent: true,
                direction: 'top',
                className: 'city-label'
            }).openTooltip();
        });
    }
}